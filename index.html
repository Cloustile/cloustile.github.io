<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title> å‘ç°å±äºä½ çš„æµåŠ¨çš„ç››å®´ </title>
    
    <!-- æš—è‰²æ¨¡å¼åˆ‡æ¢å›¾æ ‡ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.bootcdn.net/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
    
    <!-- html2canvas ç”¨äºæˆªå›¾ä¿å­˜ -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <style>
      /* ================= å˜é‡å®šä¹‰ ================= */
      :root {
        --primary: #6366f1;
        --accent: #ec4899;
        --bg: #f8fafc;
        --card: #ffffff;
        --text-main: #1e293b;
        --text-sub: #64748b;
        --border: #e2e8f0;
        --shadow: rgba(0, 0, 0, 0.15);
        --grid-color: #e2e8f0;
      }

      /* æš—è‰²æ¨¡å¼å˜é‡ */
      .dark-mode {
        --primary: #818cf8;
        --accent: #f472b6;
        --bg: #0f172a;
        --card: #1e293b;
        --text-main: #f1f5f9;
        --text-sub: #94a3b8;
        --border: #334155;
        --shadow: rgba(0, 0, 0, 0.4);
        --grid-color: #334155;
      }

      /* ================= åŸºç¡€æ ·å¼ ================= */
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        background-color: var(--bg);
        color: var(--text-main);
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background-image: 
          linear-gradient(var(--grid-color) 1px, transparent 1px), 
          linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
        background-size: 20px 20px;
        transition: background-color 0.3s, color 0.3s;
      }

      .container {
        width: 90%;
        max-width: 500px;
        background: var(--card);
        padding: 30px;
        border-radius: 24px;
        box-shadow: 0 25px 50px -12px var(--shadow);
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        max-height: 95vh;
        transition: background-color 0.3s, box-shadow 0.3s;
      }

      /* ================= æš—è‰²æ¨¡å¼åˆ‡æ¢æŒ‰é’® ================= */
      .theme-toggle {
        position: absolute;
        top: 20px;
        right: 20px;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--bg);
        border: 1px solid var(--border);
        color: var(--text-main);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        transition: all 0.3s;
        z-index: 1000;
      }

      .theme-toggle:hover {
        transform: rotate(30deg);
        box-shadow: 0 0 10px rgba(99, 102, 241, 0.3);
      }

      /* ================= éªŒè¯ç é¡µé¢ ================= */
      #captcha-screen {
        text-align: center;
        justify-content: center;
        align-items: center;
      }

      .captcha-input {
        width: 50%;
        padding: 15px;
        font-size: 14px;
        text-align: center;
        border: 1px solid var(--border);
        border-radius: 12px;
        margin: 20px 0;
        outline: none;
        letter-spacing: 5px;
        color: var(--primary);
        transition: all 0.3s;
        background: var(--card);
        color: var(--text-main);
      }

      .captcha-input:focus {
        border-color: var(--primary);
        box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
      }

      .captcha-btn {
        background: linear-gradient(90deg, var(--primary), var(--accent));
        color: white;
        border: none;
        padding: 12px 40px;
        font-size: 16px;
        border-radius: 50px;
        cursor: pointer;
        font-weight: 600;
        box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
        transition: transform 0.2s;
      }

      .captcha-btn:active {
        transform: scale(0.95);
      }

      /* ================= å¤´éƒ¨åŒºåŸŸ ================= */
      .header {
        text-align: center;
        margin-bottom: 20px;
        flex-shrink: 0;
      }

      .header h1 {
        font-size: 22px;
        font-weight: 800;
        color: var(--text-main);
        margin: 0 0 5px 0;
      }

      .header p {
        color: var(--text-sub);
        font-size: 13px;
        margin: 0;
      }

      /* ================= è¿›åº¦æ¡ ================= */
      .progress-bar {
        width: 100%;
        height: 4px;
        background: var(--border);
        border-radius: 2px;
        margin-bottom: 20px;
        flex-shrink: 0;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--primary), var(--accent));
        width: 0%;
        transition: width 0.3s ease;
      }

      /* ================= é—®é¢˜åŒºåŸŸ ================= */
      #quiz-container {
        overflow-y: auto;
        flex-grow: 1;
        padding-bottom: 10px;
        scrollbar-width: none;
        -ms-overflow-style: none;
      }

      #quiz-container::-webkit-scrollbar {
        display: none;
      }

      .question-card {
        display: none;
        animation: fadeIn 0.3s ease;
      }

      .question-card.active {
        display: block;
      }

      .question-title {
        font-size: 18px;
        font-weight: 700;
        margin: 25px 0 30px 0;
        line-height: 1.4;
        color: var(--text-main);
      }

      /* ================= é€‰é¡¹ ================= */
      .options-grid {
        display: grid;
        gap: 10px;
      }

      .option-btn {
        background: var(--card);
        border: 1px solid var(--border);
        padding: 14px 16px;
        border-radius: 12px;
        text-align: left;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        color: var(--text-main);
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
      }

      .option-btn:hover {
        border-color: var(--primary);
        background-color: rgba(99, 102, 241, 0.1);
      }

      .option-btn.selected {
        border-color: var(--primary);
        background-color: rgba(99, 102, 241, 0.15);
        color: var(--primary);
        font-weight: 600;
        box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
      }

      /* ================= å¯¼èˆªæŒ‰é’® ================= */
      .action-bar {
        margin-top: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 10px;
        border-top: 1px solid var(--border);
        flex-shrink: 0;
      }

      .nav-btn {
        border: none;
        background: none;
        color: var(--text-sub);
        font-size: 14px;
        cursor: pointer;
        padding: 8px 15px;
        border-radius: 8px;
        transition: background 0.2s;
      }

      .nav-btn:hover {
        background: rgba(148, 163, 184, 0.1);
        color: var(--text-main);
      }

      .nav-btn:disabled {
        opacity: 0.3;
        cursor: not-allowed;
      }

      .confirm-btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 10px 24px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 4px 6px -1px rgba(99, 102, 241, 0.4);
        display: none;
      }

      .confirm-btn:active {
        transform: scale(0.98);
      }

      /* ================= ç»“æœé¡µé¢ ================= */
      #result-screen {
        display: none;
        text-align: center;
        overflow-y: auto;
        max-height: 100%;
        padding-right: 5px;
      }

      .result-city-name {
        font-size: 48px;
        font-weight: 900;
        background: linear-gradient(135deg, var(--primary), var(--accent));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin: 5px 0 10px;
        letter-spacing: 2px;
      }

      .result-tag-cloud {
        display: flex;
        justify-content: center;
        gap: 6px;
        flex-wrap: wrap;
        margin-bottom: 15px;
      }

      .result-tag {
        background: rgba(148, 163, 184, 0.1);
        color: var(--text-sub);
        padding: 4px 10px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
        border: 1px solid var(--border);
      }

      .chart-container {
        position: relative;
        height: 250px;
        width: 100%;
        margin: 10px 0 20px 0;
        display: block;
      }

      .result-desc {
        font-size: 14px;
        line-height: 1.7;
        color: var(--text-sub);
        background: rgba(148, 163, 184, 0.05);
        padding: 15px;
        border-radius: 16px;
        text-align: left;
        margin-bottom: 20px;
        border: 1px solid var(--border);
      }

      .plan-b {
        background: var(--card);
        border: 1px dashed var(--border);
        padding: 15px;
        border-radius: 12px;
        margin-bottom: 20px;
        text-align: left;
      }

      .city-link-btn {
        display: inline-block;
        margin: 5px;
        padding: 6px 12px;
        background-color: rgba(148, 163, 184, 0.1);
        border-radius: 8px;
        cursor: pointer;
        font-size: 13px;
        color: var(--text-sub);
        font-weight: 600;
        border: 1px solid transparent;
        transition: all 0.2s;
      }

      .city-link-btn:hover {
        background-color: rgba(99, 102, 241, 0.1);
        color: var(--primary);
        border-color: var(--primary);
      }

      .city-link-btn.active {
        background-color: var(--primary);
        color: white;
        box-shadow: 0 2px 5px rgba(99, 102, 241, 0.3);
      }

      /* ================= ç»“æœé¡µé¢æŒ‰é’® ================= */
      .result-actions {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-top: 20px;
        flex-wrap: wrap;
      }

      .result-btn {
        background: var(--card);
        border: 1px solid var(--border);
        color: var(--text-main);
        padding: 10px 20px;
        border-radius: 12px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.2s;
      }

      .result-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .result-btn.save {
        background: linear-gradient(90deg, var(--primary), var(--accent));
        color: white;
        border: none;
      }

      .result-btn.restart {
        background: rgba(148, 163, 184, 0.1);
      }

      /* ================= åŠ è½½åŠ¨ç”» ================= */
      #loading {
        display: none;
        text-align: center;
        padding: 40px;
      }

      .loading-spinner {
        width: 50px;
        height: 50px;
        border: 3px solid var(--border);
        border-top-color: var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(5px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* ================= ç‰ˆæƒä¿¡æ¯ ================= */
      .copyright-footer {
        position: fixed;
        bottom: 5px;
        left: 0;
        width: 100%;
        text-align: center;
        padding: 10px 0;
        background-color: var(--bg);
        font-size: 10px;
        color: var(--text-sub);
        line-height: 1.4;
        z-index: 9999;
        user-select: none;
        -webkit-user-select: none;
        transition: background-color 0.3s, color 0.3s;
      }
    </style>
</head>
<body>
    <!-- æš—è‰²æ¨¡å¼åˆ‡æ¢æŒ‰é’® -->
    <button class="theme-toggle" id="theme-toggle">
        <i class="fas fa-moon"></i>
    </button>

    <!-- éªŒè¯ç é¡µé¢ -->
    <div class="container" id="captcha-screen">
        <div style="font-size: 50px; margin-bottom: 10px">âœˆï¸ </div>
        <div class="header">
            <h1>å¼€å¯æ—…ç¨‹</h1>
            <p>çµé­‚ï¼Œå¤§åœ°ä¸Šçš„å¼‚ä¹¡è€…</p>
        </div>
        <input type="tel" id="captcha-input" class="captcha-input" placeholder="è¯·è¾“å…¥éªŒè¯ç " maxlength="4" />
        <button class="captcha-btn" onclick="verifyCaptcha()">è§£é”æŠ¥å‘Š</button>
        <div id="error-msg" style="color: #ef4444; font-size: 13px; margin-top: 15px; display: none">éªŒè¯ç é”™è¯¯ï¼Œè¯·é‡è¯•</div>
    </div>

    <!-- ä¸»æµ‹è¯•é¡µé¢ -->
    <div class="container" id="quiz-app" style="display: none">
        <div class="header">
            <h1>å‘ç°å±äºä½ çš„æµåŠ¨çš„ç››å®´</h1>
            <p>æ¯ä¸€ä½å¤§åœ°ä¸Šçš„å¼‚ä¹¡è€…ï¼Œéƒ½ä¼šæœ‰ç‹¬å±çš„çµé­‚æ –å±…ä¹‹æ‰€</p>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progress"></div>
        </div>

        <div id="quiz-container"></div>

        <div id="loading" style="display: none; text-align: center; padding: 40px">
            <div class="loading-spinner"></div>
            <div style="margin-top: 15px; color: var(--text-sub)">æ­£åœ¨å‘ç°ä½ çš„çµé­‚æ –å±…æ‰€</div>
        </div>

        <div id="result-screen">
            <div style="font-size: 40px"></div>
            <div style="font-size: 13px; color: var(--text-sub); margin-top: 5px">ä½ çš„çµé­‚æ –å±…åœ¨</div>

            <div class="result-city-name" id="city-name">--</div>
            <div class="result-tag-cloud" id="city-tags"></div>

            <div class="chart-container">
                <canvas id="radarChart"></canvas>
            </div>

            <div class="result-desc" id="city-desc"></div>

            <div class="plan-b">
                <div style="font-size: 12px; color: var(--text-sub); margin-bottom: 10px; font-weight: 700">
                    ğŸ“‹ å…¶ä»–åŒ¹é…åŸå¸‚ï¼ˆç‚¹å‡»åˆ‡æ¢ï¼‰
                </div>
                <div id="second-options-container" style="display: flex; flex-wrap: wrap; gap: 5px"></div>
            </div>

            <!-- ç»“æœé¡µé¢æŒ‰é’® -->
            <div class="result-actions">
                <button class="result-btn save" onclick="saveResultAsImage()">
                    <i class="fas fa-camera"></i> ä¿å­˜ç»“æœ
                </button>
                <button class="result-btn restart" onclick="restartTest()">
                    <i class="fas fa-redo"></i> é‡æ–°æµ‹è¯•
                </button>
            </div>
        </div>

        <div class="action-bar" id="action-bar" style="display: none">
            <button class="nav-btn" id="prev-btn" onclick="prevStep()">â† ä¸Šä¸€é¢˜</button>
            <button class="confirm-btn" id="confirm-btn" onclick="confirmMultiSelection()">ç¡®è®¤é€‰æ‹©</button>
        </div>
    </div>

    <div class="copyright-footer">
        è¯¥æµ‹è¯•ç”±Data Mining Labæä¾› â€¢ ç»“æœä»…ä¾›å‚è€ƒ<br />
    </div>

    <script>
        // ================= å…¨å±€å˜é‡ =================
        const correctCaptcha = "0000"; // éªŒè¯ç 
        let chartInstance = null;
        let currentStep = 0;
        let selectionHistory = [];

        // ================= æš—è‰²æ¨¡å¼åˆ‡æ¢ =================
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = themeToggle.querySelector('i');
        
        // æ£€æŸ¥æœ¬åœ°å­˜å‚¨çš„ä¸»é¢˜åå¥½
        const savedTheme = localStorage.getItem('theme') || 'light';
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
            themeIcon.className = 'fas fa-sun';
        }
        
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            
            if (document.body.classList.contains('dark-mode')) {
                themeIcon.className = 'fas fa-sun';
                localStorage.setItem('theme', 'dark');
            } else {
                themeIcon.className = 'fas fa-moon';
                localStorage.setItem('theme', 'light');
            }
        });

        // ================= 1. éªŒè¯ç åŠŸèƒ½ =================
        document.getElementById("captcha-input").addEventListener("keypress", function (e) {
            if (e.key === "Enter") verifyCaptcha();
        });

        function verifyCaptcha() {
            const input = document.getElementById("captcha-input");
            const errorMsg = document.getElementById("error-msg");
            
            if (input.value.trim() === correctCaptcha) {
                document.getElementById("captcha-screen").style.display = "none";
                document.getElementById("quiz-app").style.display = "flex";
                initQuiz();
            } else {
                errorMsg.style.display = "block";
                input.style.borderColor = "#ef4444";
                input.value = "";
                input.focus();
            }
        }

        // ================= 2. åŸå¸‚æ•°æ®åº“ =================
        const cities = [
            {
                name: "å¤§ç†",
                tags: { sea: -1, chill: 10, lowHousePrice: 8, warm: 8, nature: 10, slow: 10, edu: 2, medical: 2, romantic: 9 },
                displayTags: ["é£èŠ±é›ªæœˆ", "æ…¢ç”Ÿæ´»", "æ–‡è‰ºé’å¹´"],
                desc: "ä½ æ˜¯è¿½æ±‚ç²¾ç¥è‡ªç”±çš„æ—…äººã€‚å¤§ç†çš„è‹å±±æ´±æµ·ã€å¤åŸçŸ³æ¿è·¯å’Œæ–‡è‰ºæ°”æ¯ï¼Œæ˜¯é€ƒç¦»éƒ½å¸‚å–§åš£çš„ç†æƒ³ä¹‹åœ°ã€‚è¿™é‡Œé€‚åˆæ•°å­—æ¸¸æ°‘ã€è‡ªç”±èŒä¸šè€…ï¼Œæˆ–è€…æ¸´æœ›åœ¨è‡ªç„¶ä¸­å¯»æ‰¾è‡ªæˆ‘çš„ä½ ã€‚",
            },
            {
                name: "æˆéƒ½",
                tags: { sea: -1, chill: 9, lowHousePrice: 7, warm: 6, spicy: 10, ent: 10, edu: 8, medical: 9, food: 10 },
                displayTags: ["å¤©åºœä¹‹å›½", "ç¾é£Ÿä¹‹éƒ½", "å·´é€‚ç”Ÿæ´»"],
                desc: "ä½ æ‡‚å¾—äº«å—ç”Ÿæ´»ï¼Œè¿½æ±‚å·¥ä½œä¸ç”Ÿæ´»çš„å¹³è¡¡ã€‚æˆéƒ½æœ‰é¡¶çº§åŒ»ç–—èµ„æºï¼ˆåè¥¿åŒ»é™¢ï¼‰ã€ä¸°å¯Œçš„ç¾é£Ÿå’Œæ‚ é—²çš„ç”Ÿæ´»èŠ‚å¥ã€‚è¿™é‡ŒåŒ…å®¹å¼€æ”¾ï¼Œæ—¢æœ‰å‘å±•æœºä¼šï¼Œä¹Ÿæœ‰æ‰“éº»å°†å–èŒ¶çš„é—²é€‚ã€‚",
            },
            {
                name: "ä¸Šæµ·",
                tags: { sea: -1, chill: 3, lowHousePrice: -10, warm: 6, fashion: 10, finance: 10, edu: 10, medical: 10, modern: 10 },
                displayTags: ["å›½é™…é­”éƒ½", "ç²¾è‡´ç”Ÿæ´»", "æœºé‡ä¹‹åŸ"],
                desc: "ä½ è¿½æ±‚å“è¶Šï¼Œå‘å¾€å›½é™…åŒ–ã€ç²¾è‡´çš„ç”Ÿæ´»æ–¹å¼ã€‚ä¸Šæµ·æœ‰æœ€å‰æ²¿çš„æ—¶å°šã€æœ€å¤šçš„èŒä¸šæœºä¼šå’Œé¡¶çº§çš„åŒ»ç–—æ•™è‚²èµ„æºã€‚è¿™é‡Œç«äº‰æ¿€çƒˆä½†å›æŠ¥ä¸°åšï¼Œé€‚åˆæœ‰é‡å¿ƒçš„å¥‹æ–—è€…ã€‚",
            },
            {
                name: "é‡åº†",
                tags: { sea: -1, chill: 7, lowHousePrice: 8, warm: 8, spicy: 10, mountains: 10, edu: 7, medical: 8, nightLife: 9 },
                displayTags: ["å±±åŸ", "ç«é”…ä¹‹éƒ½", "8Dé­”å¹»"],
                desc: "ä½ æ€§æ ¼ç›´çˆ½ï¼Œå–œæ¬¢æœ‰ç‰¹è‰²çš„åŸå¸‚æ™¯è§‚å’Œçƒ­è¾£çš„ç”Ÿæ´»ã€‚é‡åº†çš„ç«‹ä½“äº¤é€šã€å¤œæ™¯å’Œç«é”…æ–‡åŒ–ç‹¬å…·é­…åŠ›ã€‚è¿™é‡Œäººçƒ­æƒ…è±ªçˆ½ï¼Œç”Ÿæ´»æˆæœ¬ç›¸å¯¹è¾ƒä½ï¼Œé€‚åˆå–œæ¬¢çƒŸç«æ°”çš„ä½ ã€‚",
            },
            {
                name: "æ­å·",
                tags: { sea: -1, chill: 5, lowHousePrice: -5, warm: 7, ecom: 10, garden: 9, edu: 9, medical: 8, tech: 9 },
                displayTags: ["ç”µå•†ä¹‹éƒ½", "è¥¿æ¹–ç¾æ™¯", "æ•°å­—ä¹‹åŸ"],
                desc: "ä½ æ—¢æƒ³è¿½æ±‚äº‹ä¸šæˆåŠŸï¼Œåˆå‘å¾€è¯—æ„ç”Ÿæ´»ã€‚æ­å·æ˜¯äº’è”ç½‘å’Œç”µå•†ä¸­å¿ƒï¼ŒåŒæ—¶æ‹¥æœ‰è¥¿æ¹–ç¾æ™¯å’Œæ±Ÿå—éŸµå‘³ã€‚è¿™é‡Œé€‚åˆå¸Œæœ›åœ¨ç§‘æŠ€è¡Œä¸šå‘å±•çš„æ–‡è‰ºé’å¹´ã€‚",
            },
            {
                name: "åŒ—äº¬",
                tags: { sea: -1, chill: 2, lowHousePrice: -10, warm: 3, gov: 10, culture: 10, edu: 10, medical: 10, history: 10 },
                displayTags: ["é¦–éƒ½", "æ–‡åŒ–ä¸­å¿ƒ", "èµ„æºé«˜åœ°"],
                desc: "ä½ è¿½æ±‚é¡¶çº§èµ„æºå’Œå®å¤§å¹³å°ï¼Œèƒ½å¤Ÿæ‰¿å—å¿«èŠ‚å¥å’Œé«˜å‹åŠ›ã€‚åŒ—äº¬æœ‰æœ€å¥½çš„æ•™è‚²ã€åŒ»ç–—å’Œæ–‡åŒ–èµ„æºï¼Œé€‚åˆæœ‰é›„å¿ƒå£®å¿—ã€æƒ³åœ¨ä½“åˆ¶å†…æˆ–å¤§å¹³å°å‘å±•çš„ä½ ã€‚",
            },
            {
                name: "æ·±åœ³",
                tags: { sea: 1, chill: 2, lowHousePrice: -8, warm: 9, tech: 10, hustle: 10, edu: 7, medical: 8, young: 10 },
                displayTags: ["åˆ›æ–°ä¹‹éƒ½", "é’æ˜¥ä¹‹åŸ", "æé’±ç¬¬ä¸€"],
                desc: "ä½ æ˜¯å……æ»¡æ´»åŠ›çš„å¥‹æ–—è€…ï¼Œè¿½æ±‚æ•ˆç‡ã€åˆ›æ–°å’Œé«˜æ”¶å…¥ã€‚æ·±åœ³å¹´è½»ã€å¼€æ”¾ã€å……æ»¡æœºä¼šï¼Œé€‚åˆæƒ³åœ¨ç§‘æŠ€ã€é‡‘èé¢†åŸŸå¿«é€Ÿå‘å±•çš„å¹´è½»äººã€‚",
            },
            {
                name: "è¥¿å®‰",
                tags: { sea: -1, chill: 6, lowHousePrice: 7, warm: 5, history: 10, heavyFood: 9, edu: 9, medical: 8, culture: 9 },
                displayTags: ["å¤éƒ½", "ç¢³æ°´å¤©å ‚", "æ–‡åŒ–åº•è•´"],
                desc: "ä½ çƒ­çˆ±å†å²å’Œæ–‡åŒ–ï¼Œå–œæ¬¢æœ‰åšé‡æ„Ÿçš„åŸå¸‚ã€‚è¥¿å®‰æœ‰æ·±åšçš„å†å²åº•è•´ã€ä¸°å¯Œçš„ç¾é£Ÿå’Œç›¸å¯¹è¾ƒä½çš„ç”Ÿæ´»æˆæœ¬ï¼Œé€‚åˆå–œæ¬¢ä¼ ç»Ÿæ–‡åŒ–åˆå¸Œæœ›æœ‰ç°ä»£ä¾¿åˆ©çš„ä½ ã€‚",
            },
            {
                name: "å¹¿å·",
                tags: { sea: -1, chill: 6, lowHousePrice: -3, warm: 9, lightFood: 10, trade: 10, edu: 9, medical: 9, pragmatic: 10 },
                displayTags: ["ç¾é£Ÿå¤©å ‚", "åŠ¡å®ä¹‹åŸ", "å•†è´¸ä¹‹éƒ½"],
                desc: "ä½ åŠ¡å®ä½è°ƒï¼Œæ³¨é‡ç”Ÿæ´»å“è´¨å’Œç¾é£Ÿä½“éªŒã€‚å¹¿å·ç”Ÿæ´»æ°”æ¯æµ“åšï¼ŒåŒ»ç–—æ•™è‚²èµ„æºä¼˜ç§€ï¼Œæˆ¿ä»·ç›¸å¯¹ä¸€çº¿åŸå¸‚æ›´å‹å¥½ï¼Œé€‚åˆè¿½æ±‚æ€§ä»·æ¯”çš„åŠ¡å®æ´¾ã€‚",
            },
            {
                name: "é•¿æ²™",
                tags: { sea: -1, chill: 8, lowHousePrice: 8, warm: 7, spicy: 9, ent: 10, edu: 8, medical: 8, nightLife: 10 },
                displayTags: ["å¨±ä¹ä¹‹éƒ½", "æˆ¿ä»·æ´¼åœ°", "ä¸å¤œåŸ"],
                desc: "ä½ çƒ­çˆ±ç”Ÿæ´»ï¼Œå–œæ¬¢çƒ­é—¹å’Œå¨±ä¹ã€‚é•¿æ²™æˆ¿ä»·å‹å¥½ã€å¤œç”Ÿæ´»ä¸°å¯Œã€ç¾é£Ÿå¤šæ ·ï¼Œé€‚åˆè¿½æ±‚å¿«ä¹ç”Ÿæ´»ã€ä¸æƒ³è¢«æˆ¿è´·å‹å®çš„å¹´è½»äººã€‚",
            },
            {
                name: "ä¸½æ±Ÿ",
                tags: { sea: -1, chill: 10, lowHousePrice: 7, warm: 7, nature: 10, romantic: 10, edu: 2, medical: 3, slow: 10 },
                displayTags: ["å¤åŸéŸµå‘³", "è‰³é‡ä¹‹éƒ½", "æ…¢æ—¶å…‰"],
                desc: "ä½ å‘å¾€è¯—å’Œè¿œæ–¹ï¼Œæ¸´æœ›é€ƒç¦»éƒ½å¸‚çš„å–§åš£ã€‚ä¸½æ±Ÿçš„å¤åŸã€é›ªå±±å’Œæ…¢èŠ‚å¥ç”Ÿæ´»ï¼Œæ˜¯æ–‡è‰ºé’å¹´å’Œè¿½æ±‚å¿ƒçµè‡ªç”±è€…çš„ç†æƒ³ä¹‹åœ°ã€‚",
            },
            {
                name: "ä¸‰äºš",
                tags: { sea: 10, chill: 9, lowHousePrice: -5, warm: 10, nature: 9, tourism: 10, edu: 4, medical: 5, vacation: 10 },
                displayTags: ["çƒ­å¸¦å¤©å ‚", "åº¦å‡èƒœåœ°", "æµ·æ»¨ç”Ÿæ´»"],
                desc: "ä½ çƒ­çˆ±é˜³å…‰ã€æ²™æ»©å’Œå¤§æµ·ï¼Œè¿½æ±‚åº¦å‡èˆ¬çš„ç”Ÿæ´»ã€‚ä¸‰äºšæœ‰ä¸­å›½æœ€ç¾çš„æµ·æ»©å’Œæ¸©æš–çš„æ°”å€™ï¼Œé€‚åˆå–œæ¬¢æ°´ä¸Šè¿åŠ¨ã€è¿½æ±‚ä¼‘é—²ç”Ÿæ´»çš„äººã€‚",
            },
            {
                name: "é’å²›",
                tags: { sea: 9, chill: 7, lowHousePrice: 4, warm: 6, beer: 10, nature: 8, edu: 7, medical: 7, european: 8 },
                displayTags: ["çº¢ç“¦ç»¿æ ‘", "å•¤é…’ä¹‹åŸ", "æµ·æ»¨é£æƒ…"],
                desc: "ä½ å–œæ¬¢æœ‰ç‰¹è‰²çš„æµ·æ»¨åŸå¸‚ï¼Œäº«å—å•¤é…’ã€æµ·é²œå’Œæ¬§å¼å»ºç­‘ã€‚é’å²›æ°”å€™å®œäººï¼Œç”Ÿæ´»èŠ‚å¥é€‚ä¸­ï¼Œé€‚åˆå–œæ¬¢æµ·æ´‹æ–‡åŒ–åˆå¸Œæœ›æœ‰åŸå¸‚ä¾¿åˆ©çš„ä½ ã€‚",
            },
            {
                name: "å¦é—¨",
                tags: { sea: 9, chill: 8, lowHousePrice: -6, warm: 9, romantic: 10, clean: 10, edu: 8, medical: 7, island: 10 },
                displayTags: ["æµ·ä¸ŠèŠ±å›­", "æ–‡è‰ºæ¸…æ–°", "æ…¢ç”Ÿæ´»"],
                desc: "ä½ è¿½æ±‚æµªæ¼«ã€ç²¾è‡´çš„ç”Ÿæ´»ç¯å¢ƒã€‚å¦é—¨æœ‰ç¾ä¸½çš„æµ·å²¸çº¿ã€æ–‡è‰ºçš„é¼“æµªå±¿å’Œå¹²å‡€çš„åŸå¸‚ç¯å¢ƒï¼Œé€‚åˆå–œæ¬¢å°èµ„æƒ…è°ƒã€æ³¨é‡ç”Ÿæ´»å“è´¨çš„ä½ ã€‚",
            },
            {
                name: "è‹å·",
                tags: { sea: -1, chill: 7, lowHousePrice: -2, warm: 7, garden: 10, manu: 9, edu: 8, medical: 7, culture: 9 },
                displayTags: ["å›­æ—ä¹‹åŸ", "æ±Ÿå—æ°´ä¹¡", "å·¥ä¸šå¼ºå¸‚"],
                desc: "ä½ æ¬£èµå¤å…¸ç¾ï¼Œåˆé‡è§†ç°ä»£äº§ä¸šå‘å±•ã€‚è‹å·å®Œç¾èåˆäº†å¤å…¸å›­æ—å’Œç°ä»£å·¥ä¸šå›­åŒºï¼Œæ—¢æœ‰æ–‡åŒ–åº•è•´åˆæœ‰ç»æµæ´»åŠ›ï¼Œé€‚åˆè¿½æ±‚å¹³è¡¡å‘å±•çš„ä½ ã€‚",
            },
            {
                name: "å—äº¬",
                tags: { sea: -1, chill: 6, lowHousePrice: -1, warm: 7, history: 9, edu: 10, medical: 9, culture: 9, stable: 8 },
                displayTags: ["å…­æœå¤éƒ½", "æ•™è‚²é‡é•‡", "æ–‡åŒ–ååŸ"],
                desc: "ä½ é‡è§†æ•™è‚²å’Œæ–‡åŒ–ï¼Œå–œæ¬¢æœ‰å†å²åº•è•´çš„åŸå¸‚ã€‚å—äº¬é«˜æ ¡äº‘é›†ï¼ŒåŒ»ç–—èµ„æºä¼˜ç§€ï¼Œç”Ÿæ´»èŠ‚å¥é€‚ä¸­ï¼Œé€‚åˆé‡è§†å­å¥³æ•™è‚²å’Œä¸ªäººå‘å±•çš„å®¶åº­ã€‚",
            },
            {
                name: "æ­¦æ±‰",
                tags: { sea: -1, chill: 5, lowHousePrice: 6, warm: 8, heavyFood: 9, river: 10, edu: 9, medical: 9, hub: 10 },
                displayTags: ["æ±ŸåŸ", "è¿‡æ—©ä¹‹éƒ½", "ä¹çœé€šè¡¢"],
                desc: "ä½ æ€§æ ¼è±ªçˆ½ï¼Œå–œæ¬¢å¤§æ±Ÿå¤§æ²³çš„æ°”åŠ¿ã€‚æ­¦æ±‰åœ°ç†ä½ç½®ä¼˜è¶Šï¼ŒåŒ»ç–—æ•™è‚²èµ„æºå¼ºå¤§ï¼Œç”Ÿæ´»æˆæœ¬é€‚ä¸­ï¼Œé€‚åˆå–œæ¬¢çƒ­é—¹ã€è¿½æ±‚ä¾¿åˆ©äº¤é€šçš„ä½ ã€‚",
            },
            {
                name: "æ³‰å·",
                tags: { sea: 1, chill: 7, lowHousePrice: 7, warm: 9, history: 9, business: 8, edu: 6, medical: 6, culture: 9 },
                displayTags: ["æµ·ä¸Šä¸ç»¸ä¹‹è·¯", "é—½å—æ–‡åŒ–", "æ°‘è¥ç»æµ"],
                desc: "ä½ å–œæ¬¢æœ‰ç‹¬ç‰¹æ–‡åŒ–åº•è•´çš„æ²¿æµ·åŸå¸‚ã€‚æ³‰å·æ˜¯æµ·ä¸Šä¸ç»¸ä¹‹è·¯èµ·ç‚¹ï¼Œé—½å—æ–‡åŒ–æµ“éƒï¼Œæ°‘è¥ç»æµæ´»è·ƒï¼Œé€‚åˆå–œæ¬¢å†å²æ–‡åŒ–åˆå¸Œæœ›æœ‰å•†ä¸šæœºä¼šçš„ä½ ã€‚",
            },
            {
                name: "é¦™æ¸¯",
                tags: { sea: 1, chill: 2, lowHousePrice: -10, warm: 9, finance: 10, foreign: 10, edu: 10, medical: 10, hustle: 10 },
                displayTags: ["å›½é™…éƒ½ä¼š", "è´­ç‰©å¤©å ‚", "é‡‘èä¸­å¿ƒ"],
                desc: "ä½ è¿½æ±‚å›½é™…åŒ–ã€é«˜æ•ˆç‡çš„ç”Ÿæ´»ï¼Œèƒ½å¤Ÿæ‰¿å—é«˜å‹åŠ›å’Œé«˜æˆæœ¬ã€‚é¦™æ¸¯æ˜¯äºšæ´²é‡‘èä¸­å¿ƒï¼Œä¸­è¥¿æ–‡åŒ–äº¤èï¼Œé€‚åˆè¿½æ±‚é¡¶å°–èŒä¸šå‘å±•å’Œå›½é™…è§†é‡çš„ä½ ã€‚",
            },
            {
                name: "å°åŒ—",
                tags: { sea: -1, chill: 7, lowHousePrice: -5, warm: 9, food: 10, culture: 9, edu: 9, medical: 9, friendly: 9 },
                displayTags: ["ç¾é£Ÿä¹‹éƒ½", "æ–‡åŒ–å¤šå…ƒ", "äººæƒ…å‘³æµ“"],
                desc: "ä½ æ³¨é‡ç”Ÿæ´»ç»†èŠ‚ï¼Œå–œæ¬¢å¤šå…ƒæ–‡åŒ–å’Œç¾é£Ÿã€‚å°åŒ—ä»¥ä¸°å¯Œçš„å°åƒã€ä¾¿æ·çš„ç”Ÿæ´»å’Œæµ“åšçš„äººæƒ…å‘³è‘—ç§°ï¼Œé€‚åˆè¿½æ±‚ç”Ÿæ´»å“è´¨å’Œæ–‡åŒ–ä½“éªŒçš„ä½ ã€‚",
            },
            {
                name: "æ‰¬å·",
                tags: { sea: -1, chill: 8, lowHousePrice: 6, warm: 7, garden: 9, food: 9, edu: 6, medical: 6, slow: 9 },
                displayTags: ["æ·®æ‰¬èœ", "å›­æ—åŸå¸‚", "æ…¢ç”Ÿæ´»"],
                desc: "ä½ å–œæ¬¢ç²¾è‡´ã€æ‚ é—²çš„ç”Ÿæ´»æ–¹å¼ã€‚æ‰¬å·ä»¥æ·®æ‰¬èœã€å¤å…¸å›­æ—å’Œæ…¢èŠ‚å¥ç”Ÿæ´»é—»åï¼Œé€‚åˆè¿½æ±‚ç”Ÿæ´»æƒ…è¶£ã€å–œæ¬¢æ±Ÿå—æ–‡åŒ–çš„ä½ ã€‚",
            },
            {
                name: "å“ˆå°”æ»¨",
                tags: { sea: -1, chill: 6, lowHousePrice: 7, warm: 2, cold: 10, heavyFood: 9, edu: 8, medical: 8, european: 9 },
                displayTags: ["å†°åŸ", "æ¬§å¼é£æƒ…", "è±ªçˆ½çƒ­æƒ…"],
                desc: "ä½ å–œæ¬¢é²œæ˜çš„å››å­£å’Œå¼‚åŸŸé£æƒ…ï¼Œä¸æ€•å¯’å†·ã€‚å“ˆå°”æ»¨æœ‰ç‹¬ç‰¹çš„å†°é›ªæ–‡åŒ–ã€ä¿„å¼å»ºç­‘å’Œè±ªçˆ½çš„æ°‘é£ï¼Œé€‚åˆå–œæ¬¢å†¬å­£è¿åŠ¨å’Œç‰¹è‰²æ–‡åŒ–çš„ä½ ã€‚",
            },
            {
                name: "æ˜†æ˜",
                tags: { sea: -1, chill: 9, lowHousePrice: 7, warm: 8, seasons: 10, nature: 9, edu: 7, medical: 7, flowers: 10 },
                displayTags: ["æ˜¥åŸ", "é²œèŠ±ä¹‹éƒ½", "æ°”å€™å®œäºº"],
                desc: "ä½ è¿½æ±‚èˆ’é€‚çš„æ°”å€™å’Œè‡ªç„¶ç¯å¢ƒã€‚æ˜†æ˜å››å­£å¦‚æ˜¥ï¼Œé²œèŠ±å¸¸å¼€ï¼Œç”Ÿæ´»èŠ‚å¥æ‚ é—²ï¼Œé€‚åˆåŒå€¦æç«¯å¤©æ°”ã€æƒ³è¦èˆ’é€‚ç”Ÿæ´»çš„ä½ ã€‚",
            },
            {
                name: "å¨æµ·",
                tags: { sea: 10, chill: 9, lowHousePrice: 6, warm: 7, clean: 10, nature: 9, edu: 5, medical: 6, slow: 9 },
                displayTags: ["æœ€å®œå±…", "å¹²å‡€åŸå¸‚", "æµ·æ»¨æ…¢ç”Ÿæ´»"],
                desc: "ä½ è¿½æ±‚å¹²å‡€ã€å®‰é™çš„æµ·æ»¨ç”Ÿæ´»ã€‚å¨æµ·ä»¥æ´å‡€çš„ç¯å¢ƒã€ä¼˜ç¾çš„æµ·å²¸çº¿å’Œæ…¢èŠ‚å¥ç”Ÿæ´»é—»åï¼Œé€‚åˆå–œæ¬¢æµ·æ´‹ã€è¿½æ±‚å®œå±…ç¯å¢ƒçš„ä½ ã€‚",
            },
            {
                name: "æ¾³é—¨",
                tags: { sea: 1, chill: 6, lowHousePrice: -8, warm: 9, gaming: 10, portuguese: 10, edu: 7, medical: 8, blend: 10 },
                displayTags: ["ä¸­è¥¿åˆç’§", "å¨±ä¹ä¹‹éƒ½", "æ–‡åŒ–é—äº§"],
                desc: "ä½ å–œæ¬¢ä¸­è¥¿æ–‡åŒ–äº¤èçš„ç‹¬ç‰¹æ°›å›´ã€‚æ¾³é—¨æœ‰ä¸°å¯Œçš„è‘¡è„ç‰™æ–‡åŒ–é—äº§ã€ç¹åçš„å¨±ä¹ä¸šå’Œç‹¬ç‰¹çš„ç¾é£Ÿï¼Œé€‚åˆå–œæ¬¢å¤šå…ƒæ–‡åŒ–ã€è¿½æ±‚ç‹¬ç‰¹ä½“éªŒçš„ä½ ã€‚",
            },
            {
                name: "å¤§è¿",
                tags: { sea: 9, chill: 7, lowHousePrice: 5, warm: 6, clean: 9, japanese: 8, edu: 8, medical: 8, football: 9 },
                displayTags: ["åŒ—æ–¹æ˜ç ", "è¶³çƒä¹‹åŸ", "æµ·æ»¨æµªæ¼«"],
                desc: "ä½ å–œæ¬¢åŒ—æ–¹æµ·æ»¨åŸå¸‚çš„æ¸…çˆ½å’Œæµªæ¼«ã€‚å¤§è¿æ°”å€™å®œäººï¼ŒåŸå¸‚å¹²å‡€ï¼Œæœ‰æµ“åšçš„è¶³çƒæ–‡åŒ–å’Œæ—¥ä¿„å»ºç­‘é—äº§ï¼Œé€‚åˆå–œæ¬¢æµ·æ´‹è¿åŠ¨çš„åŒ—æ–¹äººã€‚",
            },
            {
                name: "ç æµ·",
                tags: { sea: 10, chill: 9, lowHousePrice: -2, warm: 9, clean: 10, garden: 9, edu: 6, medical: 6, romantic: 9 },
                displayTags: ["ç™¾å²›ä¹‹å¸‚", "å®œå±…åŸå¸‚", "æƒ…ä¾£è·¯"],
                desc: "ä½ è¿½æ±‚æµªæ¼«ã€å¹²å‡€çš„æµ·æ»¨ç”Ÿæ´»ç¯å¢ƒã€‚ç æµ·ä»¥ä¼˜ç¾çš„æµ·å²¸çº¿ã€èŠ±å›­èˆ¬çš„åŸå¸‚å’Œæ‚ é—²çš„ç”Ÿæ´»èŠ‚å¥è‘—ç§°ï¼Œé€‚åˆå–œæ¬¢æµ·æ´‹ã€è¿½æ±‚ç”Ÿæ´»å“è´¨çš„ä½ ã€‚",
            },
            {
                name: "æ— é”¡",
                tags: { sea: -1, chill: 7, lowHousePrice: 4, warm: 7, garden: 9, industry: 8, edu: 7, medical: 7, taihu: 10 },
                displayTags: ["å¤ªæ¹–æ˜ç ", "å·¥ä¸šå¼ºå¸‚", "æ±Ÿå—æ°´ä¹¡"],
                desc: "ä½ å–œæ¬¢æ±Ÿå—æ°´ä¹¡çš„éŸµå‘³å’Œç°ä»£å·¥ä¸šçš„ç»“åˆã€‚æ— é”¡æœ‰ç¾ä¸½çš„å¤ªæ¹–é£å…‰ã€å‘è¾¾çš„æ°‘è¥ç»æµå’Œé€‚ä¸­çš„ç”Ÿæ´»æˆæœ¬ï¼Œé€‚åˆè¿½æ±‚å¹³è¡¡å‘å±•çš„æ±Ÿå—çˆ±å¥½è€…ã€‚",
            },
        ];

        // ================= 3. é—®å·é…ç½® =================
        const questions = [
            {
                title: "1/20 ä½ çš„é¥®é£Ÿåå¥½æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸŒ¶ï¸ æ— è¾£ä¸æ¬¢ï¼Œå·æ¹˜æ¸èœç³»æœ€çˆ±", tags: { spicy: 10, food: 8 } },
                    { text: "ğŸœ å–œæ¬¢é¢é£Ÿå’ŒåŒ—æ–¹èœç³»", tags: { heavyFood: 10, food: 8 } },
                    { text: "ğŸ¥Ÿ åçˆ±æ¸…æ·¡é²œç”œçš„ç²¤èœæ±Ÿæµ™èœ", tags: { lightFood: 10, food: 8 } },
                    { text: "ğŸ² ä»€ä¹ˆéƒ½åƒï¼Œå–œæ¬¢å°è¯•å„åœ°ç¾é£Ÿ", tags: { food: 9, pragmatic: 8 } },
                    { text: "ğŸ¥— å¥åº·é¥®é£Ÿï¼Œæ²™æ‹‰è½»é£Ÿä¸ºä¸»", tags: { foreign: 8, food: 6 } },
                ],
            },
            {
                title: "2/20 ä½ å¯¹æ°”å€™çš„åå¥½æ˜¯ï¼Ÿ",
                options: [
                    { text: "â˜€ï¸ å–œæ¬¢æ¸©æš–ï¼Œè®¨åŒå†¬å¤©", tags: { warm: 10 } },
                    { text: "â„ï¸ å–œæ¬¢å››å­£åˆ†æ˜ï¼Œäº«å—å­£èŠ‚å˜åŒ–", tags: { seasons: 10 } },
                    { text: "ğŸŒ¤ï¸ æ¸©å’Œå®œäººï¼Œä¸è¦æç«¯å¤©æ°”", tags: { seasons: 8, warm: 6 } },
                    { text: "ğŸ–ï¸ çƒ­å¸¦æ°”å€™ï¼Œå¸¸å¹´å¤å¤©", tags: { warm: 10, sea: 5 } },
                    { text: "ğŸŒ¨ï¸ ä¸æ€•å†·ï¼Œå–œæ¬¢é›ªæ™¯", tags: { cold: 10 } },
                ],
            },
            {
                title: "3/20 ä½ ç†æƒ³çš„åŸå¸‚æ™¯è§‚æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸ™ï¸ ç°ä»£æ‘©å¤©å¤§æ¥¼ï¼Œéƒ½å¸‚æ„Ÿå¼º", tags: { modern: 10, hustle: 6 } },
                    { text: "â›°ï¸ è‡ªç„¶é£å…‰ï¼Œå±±æ°´æ¹–æµ·", tags: { nature: 10, chill: 6 } },
                    { text: "ğŸ¯ å†å²å¤è¿¹ï¼Œæ–‡åŒ–åº•è•´æ·±åš", tags: { history: 10, culture: 8 } },
                    { text: "ğŸŒŠ æµ·æ»¨åŸå¸‚ï¼Œæœ‰æ²™æ»©æµ·å²¸", tags: { sea: 10, romantic: 8 } },
                    { text: "ğŸ¡ å®‰é™å°é•‡ï¼Œç”°å›­é£å…‰", tags: { slow: 10, chill: 8 } },
                ],
            },
            {
                title: "4/20 ä½ çš„æœŸæœ›è–ªèµ„æ°´å¹³æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸ’° è¿½æ±‚é«˜è–ªï¼Œä¸æ€•åŠ ç­", tags: { hustle: 10, highSalary: 10 } },
                    { text: "âš–ï¸ ä¸­ç­‰åä¸Šï¼Œå·¥ä½œç”Ÿæ´»å¹³è¡¡", tags: { hustle: 5, chill: 6 } },
                    { text: "ğŸ’¼ ç¨³å®šå³å¯ï¼Œæ›´çœ‹é‡å…¶ä»–æ–¹é¢", tags: { stable: 10, hustle: 3 } },
                    { text: "ğŸ†“ è‡ªç”±èŒä¸šï¼Œæ”¶å…¥ä¸ç¨³å®šä½†è‡ªç”±", tags: { chill: 10, hustle: 2 } },
                ],
            },
            {
                title: "5/20 ä½ çš„èŒä¸šæ–¹å‘æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸ’» äº’è”ç½‘/ç§‘æŠ€è¡Œä¸š", tags: { tech: 10, hustle: 8 } },
                    { text: "ğŸ›ï¸ ä½“åˆ¶å†…/å…¬åŠ¡å‘˜", tags: { gov: 10, stable: 10 } },
                    { text: "ğŸ’° é‡‘è/å•†ä¸š", tags: { finance: 10, hustle: 8 } },
                    { text: "ğŸ¨ åˆ›æ„/æ–‡åŒ–/è‰ºæœ¯", tags: { culture: 10, ent: 8 } },
                    { text: "ğŸ­ åˆ¶é€ ä¸š/å®ä½“ç»æµ", tags: { manu: 10, stable: 8 } },
                    { text: "ğŸ†“ è‡ªç”±èŒä¸š/åˆ›ä¸š", tags: { business: 10, chill: 8 } },
                ],
            },
            {
                title: "6/20 ä½ å¯¹æˆ¿ä»·çš„æ€åº¦æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸ  å¿…é¡»ä¹°æˆ¿ï¼Œæ„¿æ„æ‰¿å—é«˜æˆ¿ä»·", tags: { lowHousePrice: -10, stable: 8 } },
                    { text: "ğŸ¡ å¸Œæœ›ä¹°æˆ¿ï¼Œä½†ä»·æ ¼è¦åˆç†", tags: { lowHousePrice: 5, stable: 6 } },
                    { text: "ğŸ˜ï¸ ç§Ÿæˆ¿ä¹Ÿå¯ï¼Œä¸è¢«æˆ¿è´·æŸç¼š", tags: { chill: 8, lowHousePrice: 0 } },
                    { text: "ğŸ’° æˆ¿ä»·è¶Šä½è¶Šå¥½ï¼Œç”Ÿæ´»æˆæœ¬æœ€é‡è¦", tags: { lowHousePrice: 10, pragmatic: 8 } },
                ],
            },
            {
                title: "7/20 ä½ çš„ä¸šä½™çˆ±å¥½ä¸»è¦æ˜¯ï¼Ÿ",
                options: [
                    { text: "â›°ï¸ æˆ·å¤–è¿åŠ¨ï¼Œçˆ¬å±±å¾’æ­¥", tags: { nature: 10, chill: 6 } },
                    { text: "ğŸ­ æ–‡åŒ–è‰ºæœ¯ï¼Œçœ‹å±•æ¼”å‡º", tags: { culture: 10, ent: 8 } },
                    { text: "ğŸ½ï¸ ç¾é£Ÿæ¢åº—ï¼Œäº«å—ç”Ÿæ´»", tags: { food: 10, chill: 6 } },
                    { text: "ğŸ‹ï¸ å¥èº«è¿åŠ¨ï¼Œä¿æŒå¥åº·", tags: { health: 10 } },
                    { text: "ğŸ® å®…å®¶å¨±ä¹ï¼Œæ¸¸æˆè¿½å‰§", tags: { chill: 8, ent: 6 } },
                ],
            },
            {
                title: "8/20 ä½ çš„ç¤¾äº¤åå¥½æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸ¤ å–œæ¬¢ç¤¾äº¤ï¼Œæœ‹å‹è¶Šå¤šè¶Šå¥½", tags: { humanTouch: 10, ent: 8 } },
                    { text: "ğŸ™… æ³¨é‡è¾¹ç•Œï¼Œéœ€è¦ä¸ªäººç©ºé—´", tags: { boundaries: 10, chill: 6 } },
                    { text: "ğŸ‘¥ æœ‰å°åœˆå­ï¼Œæ·±åº¦äº¤å¾€", tags: { culture: 8, humanTouch: 6 } },
                    { text: "ğŸ’¼ å·¥ä½œç¤¾äº¤ä¸ºä¸»ï¼Œå…¬ç§åˆ†æ˜", tags: { efficiency: 10, boundaries: 6 } },
                ],
            },
            {
                title: "9/20 ä½ å¯¹å­å¥³æ•™è‚²çš„é‡è§†ç¨‹åº¦ï¼Ÿ",
                options: [
                    { text: "ğŸ“ éå¸¸é‡è§†ï¼Œè¿½æ±‚é¡¶å°–æ•™è‚²èµ„æº", tags: { edu: 10, stable: 8 } },
                    { text: "ğŸ“š æ¯”è¾ƒé‡è§†ï¼Œå¸Œæœ›æœ‰è‰¯å¥½æ•™è‚²ç¯å¢ƒ", tags: { edu: 7, stable: 6 } },
                    { text: "ğŸ‘¶ é¡ºå…¶è‡ªç„¶ï¼Œå¥åº·å¿«ä¹æ›´é‡è¦", tags: { edu: 4, chill: 8 } },
                    { text: "ğŸš« ä¸å…‹æˆ–ä¸è€ƒè™‘æ­¤é—®é¢˜", tags: { chill: 10, edu: 0 } },
                ],
            },
            {
                title: "10/20 ä½ å¯¹åŒ»ç–—æ¡ä»¶çš„è¦æ±‚æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸ¥ å¿…é¡»æœ‰ä¸€æµåŒ»ç–—èµ„æº", tags: { medical: 10, stable: 8 } },
                    { text: "âš•ï¸ æœ‰è‰¯å¥½åŒ»ç–—æ¡ä»¶å³å¯", tags: { medical: 7, stable: 6 } },
                    { text: "ğŸ’Š åŸºæœ¬åŒ»ç–—èƒ½æ»¡è¶³å°±è¡Œ", tags: { medical: 4, chill: 6 } },
                    { text: "ğŸ’ª å¹´è½»å¥åº·ï¼Œä¸å¤ªå…³æ³¨", tags: { medical: 2, chill: 8 } },
                ],
            },
            {
                title: "11/20 ä½ çš„äººç”Ÿè¿½æ±‚ä¸»è¦æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸš€ äº‹ä¸šæˆåŠŸï¼Œå®ç°è‡ªæˆ‘ä»·å€¼", tags: { hustle: 10, highSalary: 8 } },
                    { text: "ğŸ˜Œ ç”Ÿæ´»å¹¸ç¦ï¼Œå®¶åº­å’Œç¦", tags: { stable: 10, chill: 8 } },
                    { text: "ğŸŒ ä½“éªŒä¸–ç•Œï¼Œè‡ªç”±æ¢ç´¢", tags: { chill: 10, foreign: 8 } },
                    { text: "ğŸ¨ ç²¾ç¥æ»¡è¶³ï¼Œè¿½æ±‚è‰ºæœ¯æ–‡åŒ–", tags: { culture: 10, ent: 8 } },
                ],
            },
            {
                title: "12/20 ä½ èƒ½æ¥å—çš„é€šå‹¤æ—¶é—´æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸš‡ 30åˆ†é’Ÿå†…ï¼Œæ—¶é—´å°±æ˜¯ç”Ÿå‘½", tags: { efficiency: 10, hustle: 6 } },
                    { text: "ğŸš— 1å°æ—¶å†…ï¼Œå¯ä»¥æ¥å—", tags: { pragmatic: 8, hustle: 4 } },
                    { text: "ğŸš² è¶ŠçŸ­è¶Šå¥½ï¼Œæœ€å¥½æ­¥è¡Œå¯è¾¾", tags: { chill: 8, efficiency: 6 } },
                    { text: "â° ä¸ä»‹æ„é€šå‹¤ï¼Œå¯ä»¥è¿œç¨‹å·¥ä½œ", tags: { chill: 10, efficiency: 4 } },
                ],
            },
            {
                title: "13/20 ä½ çš„å‘¨æœ«é€šå¸¸å¦‚ä½•å®‰æ’ï¼Ÿ",
                options: [
                    { text: "ğŸ›Œ ä¼‘æ¯æ”¾æ¾ï¼Œæ¢å¤ç²¾åŠ›", tags: { chill: 10, slow: 8 } },
                    { text: "ğŸ‰ æœ‹å‹èšä¼šï¼Œç¤¾äº¤æ´»åŠ¨", tags: { ent: 10, humanTouch: 8 } },
                    { text: "ğŸ“– å­¦ä¹ å……ç”µï¼Œæå‡è‡ªæˆ‘", tags: { hustle: 8, culture: 6 } },
                    { text: "ğŸš— å‘¨è¾¹æ—…è¡Œï¼Œæ¢ç´¢æ–°åœ°æ–¹", tags: { nature: 8, chill: 6 } },
                ],
            },
            {
                title: "14/20 ä½ å¯¹åŸå¸‚è§„æ¨¡çš„åå¥½æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸ™ï¸ è¶…å¤§åŸå¸‚ï¼Œèµ„æºä¸°å¯Œ", tags: { hustle: 10, modern: 8 } },
                    { text: "ğŸ¢ ä¸€äºŒçº¿åŸå¸‚ï¼Œå¹³è¡¡å‘å±•", tags: { stable: 8, hustle: 6 } },
                    { text: "ğŸ˜ï¸ ä¸­å°åŸå¸‚ï¼Œç”Ÿæ´»èˆ’é€‚", tags: { chill: 10, slow: 8 } },
                    { text: "ğŸ¡ å°åŸå°é•‡ï¼Œå®é™å®‰é€¸", tags: { slow: 10, chill: 10 } },
                ],
            },
            {
                title: "15/20 ä½ çš„æ¶ˆè´¹è§‚å¿µæ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸ’¸ æ³¨é‡å“è´¨ï¼Œæ„¿æ„ä¸ºä½“éªŒèŠ±é’±", tags: { fashion: 10, hustle: 6 } },
                    { text: "ğŸ’° ç†æ€§æ¶ˆè´¹ï¼Œè¿½æ±‚æ€§ä»·æ¯”", tags: { pragmatic: 10, stable: 6 } },
                    { text: "ğŸ›’ èŠ‚ä¿­ä¸ºä¸»ï¼Œèƒ½çœåˆ™çœ", tags: { lowHousePrice: 8, pragmatic: 8 } },
                    { text: "ğŸ åŠæ—¶è¡Œä¹ï¼Œäº«å—å½“ä¸‹", tags: { chill: 10, ent: 6 } },
                ],
            },
            {
                title: "16/20 ä½ å¯¹å¤œç”Ÿæ´»çš„éœ€æ±‚æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸŒƒ ä¸°å¯Œå¤šå½©ï¼Œè¶Šå¤œè¶Šç²¾å½©", tags: { nightLife: 10, ent: 8 } },
                    { text: "ğŸ¸ å¶å°”å‚ä¸ï¼Œé€‚åº¦æ”¾æ¾", tags: { nightLife: 6, ent: 6 } },
                    { text: "ğŸ® åŸºæœ¬æ²¡æœ‰ï¼Œæ—©ç¡æ—©èµ·", tags: { chill: 8, nightLife: -5 } },
                    { text: "ğŸ¶ çœ‹å¿ƒæƒ…ï¼Œæœ‰é€‰æ‹©åœ°å‚ä¸", tags: { pragmatic: 8, ent: 5 } },
                ],
            },
            {
                title: "17/20 ä½ å–œæ¬¢çš„å±…ä½åŒºåŸŸæ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸ™ï¸ å¸‚ä¸­å¿ƒï¼Œç¹åä¾¿åˆ©", tags: { hustle: 8, modern: 8 } },
                    { text: "ğŸ¡ è¿‘éƒŠåŒºï¼Œå®‰é™èˆ’é€‚", tags: { chill: 8, nature: 6 } },
                    { text: "ğŸŒŠ æµ·è¾¹æ¹–è¾¹ï¼Œé£æ™¯ä¼˜ç¾", tags: { sea: 10, nature: 8 } },
                    { text: "ğŸ¯ è€åŸåŒºï¼Œæœ‰æ–‡åŒ–æ°›å›´", tags: { history: 10, culture: 8 } },
                ],
            },
            {
                title: "18/20 ä½ çš„æ—…è¡Œåå¥½æ˜¯ï¼Ÿ",
                options: [
                    { text: "âœˆï¸ å›½é™…æ—…è¡Œï¼Œä½“éªŒå¼‚å›½æ–‡åŒ–", tags: { foreign: 10, culture: 8 } },
                    { text: "ğŸš— å›½å†…æ·±åº¦æ¸¸ï¼Œæ¢ç´¢å„åœ°", tags: { nature: 8, culture: 8 } },
                    { text: "ğŸ–ï¸ åº¦å‡æ”¾æ¾ï¼Œäº«å—é…’åº—æœåŠ¡", tags: { chill: 10, sea: 6 } },
                    { text: "ğŸš¶ åŸå¸‚æ¼«æ­¥ï¼Œæ„Ÿå—å½“åœ°ç”Ÿæ´»", tags: { culture: 10, chill: 6 } },
                ],
            },
            {
                title: "19/20 ä½ å¯¹å® ç‰©/æ¤ç‰©çš„æ€åº¦æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸ¶ å…»å® ç‰©ï¼Œæ˜¯å®¶åº­ä¸€å‘˜", tags: { chill: 8, humanTouch: 6 } },
                    { text: "ğŸŒ¿ å–œæ¬¢æ¤ç‰©ï¼Œæ‰“é€ ç»¿è‰²ç©ºé—´", tags: { nature: 10, chill: 6 } },
                    { text: "ğŸ¡ æœ‰é™¢å­æœ€å¥½ï¼Œäº²è¿‘è‡ªç„¶", tags: { nature: 10, slow: 8 } },
                    { text: "ğŸ¢ å…¬å¯“å³å¯ï¼Œç®€æ´æ–¹ä¾¿", tags: { modern: 8, efficiency: 6 } },
                ],
            },
            {
                title: "20/20 ä½ å¸Œæœ›æœªæ¥çš„ç”Ÿæ´»çŠ¶æ€æ˜¯ï¼Ÿ",
                options: [
                    { text: "ğŸš€ æŒç»­å¥‹æ–—ï¼Œä¸æ–­çªç ´", tags: { hustle: 10, highSalary: 8 } },
                    { text: "âš–ï¸ å·¥ä½œç”Ÿæ´»å¹³è¡¡ï¼Œç¨³æ­¥å‰è¿›", tags: { stable: 10, hustle: 5 } },
                    { text: "ğŸŒ¿ å›å½’è‡ªç„¶ï¼Œç®€å•ç”Ÿæ´»", tags: { chill: 10, nature: 8 } },
                    { text: "ğŸ¨ è‡ªç”±åˆ›ä½œï¼Œç²¾ç¥å¯Œè¶³", tags: { culture: 10, chill: 8 } },
                    { text: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶åº­å¹¸ç¦ï¼Œæ¸©é¦¨ç¾æ»¡", tags: { stable: 10, humanTouch: 8 } },
                ],
            },
        ];

        // ================= 4. æµ‹è¯•é€»è¾‘ =================
        function initQuiz() {
            currentStep = 0;
            selectionHistory = new Array(questions.length).fill(null);
            renderQuestion(0);
            updateProgress();
            updateNavigation();
        }

        function renderQuestion(index) {
            const container = document.getElementById("quiz-container");
            container.innerHTML = "";
            
            const q = questions[index];
            const card = document.createElement("div");
            card.className = "question-card active";
            card.innerHTML = `<div class="question-title">${q.title}</div>`;
            
            const optionsDiv = document.createElement("div");
            optionsDiv.className = "options-grid";
            
            q.options.forEach((opt, optIndex) => {
                const btn = document.createElement("button");
                btn.className = "option-btn";
                btn.innerHTML = opt.text;
                
                // æ·»åŠ å›¾æ ‡
                const iconSpan = document.createElement("span");
                iconSpan.className = "option-icon";
                iconSpan.textContent = getIconForOption(optIndex);
                btn.prepend(iconSpan);
                
                btn.onclick = () => {
                    // ç§»é™¤å…¶ä»–é€‰é¡¹çš„é€‰ä¸­çŠ¶æ€
                    document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
                    // é€‰ä¸­å½“å‰é€‰é¡¹
                    btn.classList.add('selected');
                    
                    selectionHistory[index] = [opt.tags];
                    setTimeout(() => nextStep(), 300);
                };
                
                optionsDiv.appendChild(btn);
            });
            
            card.appendChild(optionsDiv);
            container.appendChild(card);
            updateNavigation();
        }

        function getIconForOption(index) {
            const icons = ["ğŸ”´", "ğŸŸ ", "ğŸŸ¡", "ğŸŸ¢", "ğŸ”µ", "ğŸŸ£"];
            return icons[index] || "âšª";
        }

        function nextStep() {
            if (currentStep < questions.length - 1) {
                currentStep++;
                updateProgress();
                renderQuestion(currentStep);
            } else {
                calculateResult();
            }
        }

        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                updateProgress();
                renderQuestion(currentStep);
            }
        }

        function updateProgress() {
            const progress = (currentStep / questions.length) * 100;
            document.getElementById("progress").style.width = `${progress}%`;
        }

        function updateNavigation() {
            const bar = document.getElementById("action-bar");
            const prevBtn = document.getElementById("prev-btn");
            
            bar.style.display = "flex";
            prevBtn.disabled = currentStep === 0;
        }

        // ================= 5. åŒ¹é…ç®—æ³• =================
        function calculateCityScores(userTags) {
            let candidates = JSON.parse(JSON.stringify(cities));
            
            // è®¡ç®—æ¯ä¸ªåŸå¸‚çš„åŒ¹é…åˆ†æ•°
            candidates.forEach(city => {
                let score = 0;
                for (const [tag, weight] of Object.entries(userTags)) {
                    const cityVal = city.tags[tag] || 0;
                    score += cityVal * weight;
                }
                city.matchScore = score;
            });
            
            // æŒ‰åˆ†æ•°æ’åº
            candidates.sort((a, b) => b.matchScore - a.matchScore);
            
            // è®¡ç®—æ˜¾ç¤ºåˆ†æ•°ï¼ˆç™¾åˆ†æ¯”ï¼‰
            const topScore = candidates[0].matchScore;
            candidates.forEach(city => {
                city.displayScore = Math.round((city.matchScore / (topScore || 1)) * 95) + 4;
            });
            
            return candidates;
        }

        // ================= 6. é›·è¾¾å›¾ç³»ç»Ÿ =================
        const DIMENSIONS = {
            career: { label: "èŒä¸šå‘å±•", tags: ["hustle", "tech", "finance", "business", "highSalary"] },
            life: { label: "èŠ‚å¥èˆ’ç¼“", tags: ["chill", "slow", "humanTouch", "stable"] },
            culture: { label: "æ–‡åŒ–å¼€æ”¾", tags: ["culture", "foreign", "fashion", "ent", "nightLife"] },
            nature: { label: "è‡ªç„¶ç¯å¢ƒ", tags: ["nature", "sea", "warm", "seasons", "clean"] },
            cost: { label: "ç”Ÿæ´»æˆæœ¬", tags: ["lowHousePrice", "pragmatic"] },
            facility: { label: "åŸå¸‚é…å¥—", tags: ["edu", "medical", "modern", "efficiency"] },
        };

        function calculateSixDimensions(sourceData, isUser) {
            const scores = [];
            Object.keys(DIMENSIONS).forEach((dimKey) => {
                const config = DIMENSIONS[dimKey];
                let rawSum = 0;

                config.tags.forEach((tag) => {
                    const val = sourceData[tag] || 0;
                    if (isUser) {
                        if (val > 0) rawSum += val *0.8;
                    } else {
                        if (val > 0) rawSum += val * 3;
                        if (val < 0) rawSum -= Math.abs(val) * 2;
                    }
                });

                // å½’ä¸€åŒ–åˆ°40-100
                let finalScore = Math.min(100, Math.max(40, 40 + rawSum));
                scores.push(finalScore);
            });
            return scores;
        }

        function renderRadar(city, userScores) {
            if (typeof Chart === "undefined") return;
            
            const ctx = document.getElementById("radarChart");
            if (window.myRadar) window.myRadar.destroy();

            const labels = Object.values(DIMENSIONS).map((d) => d.label);
            const userRadarValues = userScores ? calculateSixDimensions(userScores, true) : [60, 60, 60, 60, 60, 60];
            const cityRadarValues = calculateSixDimensions(city.tags, false);

            window.myRadar = new Chart(ctx, {
                type: "radar",
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: city.name + "å±æ€§",
                            data: cityRadarValues,
                            backgroundColor: "rgba(200, 200, 200, 0.2)",
                            borderColor: document.body.classList.contains('dark-mode') 
                                ? "rgba(220, 220, 220, 0.8)" 
                                : "rgba(150, 150, 150, 0.8)",
                            borderWidth: 2,
                            pointRadius: 0,
                        },
                        {
                            label: "ä½ çš„åå¥½",
                            data: userRadarValues,
                            borderColor: "#6366f1",
                            backgroundColor: "rgba(99, 102, 241, 0.2)",
                            borderWidth: 2,
                            pointBackgroundColor: "#fff",
                            pointBorderColor: "#6366f1",
                        },
                    ],
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { 
                                color: document.body.classList.contains('dark-mode') 
                                    ? "rgba(255, 255, 255, 0.1)" 
                                    : "rgba(0, 0, 0, 0.1)" 
                            },
                            grid: { 
                                color: document.body.classList.contains('dark-mode') 
                                    ? "rgba(255, 255, 255, 0.1)" 
                                    : "rgba(0, 0, 0, 0.1)" 
                            },
                            pointLabels: { 
                                font: { size: 12, weight: "bold" }, 
                                color: document.body.classList.contains('dark-mode') 
                                    ? "#f1f5f9" 
                                    : "#475569" 
                            },
                            ticks: { display: false },
                            suggestedMin: 0,
                            suggestedMax: 100,
                        },
                    },
                    plugins: {
                        legend: { 
                            position: "bottom", 
                            labels: { 
                                boxWidth: 10,
                                color: document.body.classList.contains('dark-mode') 
                                    ? "#f1f5f9" 
                                    : "#475569"
                            } 
                        },
                    },
                },
            });
        }

        // ================= 7. ç»“æœè®¡ç®— =================
        function calculateResult() {
            document.getElementById("quiz-container").style.display = "none";
            document.getElementById("action-bar").style.display = "none";
            document.getElementById("loading").style.display = "block";

            setTimeout(() => {
                // æ±‡æ€»ç”¨æˆ·å¾—åˆ†
                let userScores = {};
                selectionHistory.forEach(
                    (step) =>
                        step &&
                        step.forEach((t) => {
                            for (let k in t) userScores[k] = (userScores[k] || 0) + t[k];
                        })
                );

                // è®¡ç®—åŸå¸‚åŒ¹é…
                const ranked = calculateCityScores(userScores);

                // æ˜¾ç¤ºç»“æœ
                document.getElementById("loading").style.display = "none";
                document.getElementById("result-screen").style.display = "block";

                // æ˜¾ç¤ºå† å†›åŸå¸‚
                const winner = ranked[0];
                document.getElementById("city-name").innerText = winner.name;
                document.getElementById("city-tags").innerHTML = (winner.displayTags || []).map((t) => `<span class="result-tag">${t}</span>`).join("");
                document.getElementById("city-desc").innerText = winner.desc;

                // æ¸²æŸ“é›·è¾¾å›¾
                renderRadar(winner, userScores);

                // æ¸²æŸ“å¤‡é€‰åŸå¸‚
                const otherContainer = document.getElementById("second-options-container");
                otherContainer.innerHTML = "";

                ranked.slice(0, 4).forEach((c, idx) => {
                    const el = document.createElement("div");
                    el.className = "city-link-btn";
                    if (idx === 0) el.classList.add("active");
                    el.innerText = `${c.name} (${c.displayScore}%)`;

                    el.onclick = () => {
                        document.querySelectorAll(".city-link-btn").forEach((b) => b.classList.remove("active"));
                        el.classList.add("active");

                        document.getElementById("city-name").innerText = c.name;
                        document.getElementById("city-tags").innerHTML = (c.displayTags || []).map((t) => `<span class="result-tag">${t}</span>`).join("");
                        document.getElementById("city-desc").innerText = c.desc;

                        renderRadar(c, userScores);
                    };
                    otherContainer.appendChild(el);
                });
            }, 1500);
        }

        // ================= 8. ç»“æœé¡µé¢åŠŸèƒ½ =================
        function saveResultAsImage() {
            const resultScreen = document.getElementById("result-screen");
            const buttons = document.querySelector('.result-actions');
            
            // ä¸´æ—¶éšè—æŒ‰é’®
            buttons.style.display = 'none';
            
            html2canvas(resultScreen, {
                backgroundColor: document.body.classList.contains('dark-mode') ? '#0f172a' : '#f8fafc',
                scale: 2,
                useCORS: true,
                logging: false
            }).then(canvas => {
                // æ¢å¤æŒ‰é’®æ˜¾ç¤º
                buttons.style.display = 'flex';
                
                // åˆ›å»ºä¸‹è½½é“¾æ¥
                const link = document.createElement('a');
                link.download = `åŸå¸‚åŒ¹é…ç»“æœ-${document.getElementById('city-name').textContent}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                // æ˜¾ç¤ºæˆåŠŸæç¤º
                showNotification('ç»“æœå·²ä¿å­˜ä¸ºå›¾ç‰‡ï¼');
            }).catch(error => {
                buttons.style.display = 'flex';
                showNotification('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•');
                console.error('ä¿å­˜å›¾ç‰‡å¤±è´¥:', error);
            });
        }

        function showNotification(message) {
            // åˆ›å»ºæç¤ºå…ƒç´ 
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--primary);
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                font-weight: 500;
                animation: fadeInOut 3s ease;
            `;
            
            document.body.appendChild(notification);
            
            // 3ç§’åç§»é™¤
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.5s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 500);
            }, 2500);
        }

        // æ·»åŠ CSSåŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeInOut {
                0% { opacity: 0; transform: translateY(-10px); }
                10% { opacity: 1; transform: translateY(0); }
                90% { opacity: 1; transform: translateY(0); }
                100% { opacity: 0; transform: translateY(-10px); }
            }
            @keyframes fadeOut {
                from { opacity: 1; }
                to { opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        function restartTest() {
            // é‡ç½®æ‰€æœ‰çŠ¶æ€
            currentStep = 0;
            selectionHistory = [];
            
            // åˆ‡æ¢å›é—®å·é¡µé¢
            document.getElementById("result-screen").style.display = "none";
            document.getElementById("quiz-container").style.display = "block";
            document.getElementById("action-bar").style.display = "flex";
            
            // é‡æ–°å¼€å§‹
            initQuiz();
            
            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            document.getElementById("quiz-container").scrollTop = 0;
        }

        // ================= 9. è°ƒè¯•åŠŸèƒ½ =================
        // ä¸ºæ–¹ä¾¿æµ‹è¯•ï¼Œå¯ä»¥å¿«é€Ÿè·³è½¬åˆ°ç»“æœé¡µ
        function devSkipToResult(cityName) {
            // ç›´æ¥å¡«å……æ•°æ®å¹¶è·³è½¬åˆ°ç»“æœé¡µ
            const city = cities.find(c => c.name === cityName) || cities[0];
            
            // æ¨¡æ‹Ÿç”¨æˆ·é€‰æ‹©æ•°æ®
            const userScores = {
                chill: 8,
                nature: 9,
                sea: 5,
                food: 7,
                stable: 6,
                culture: 8
            };
            
            // ç›´æ¥æ˜¾ç¤ºç»“æœ
            document.getElementById("captcha-screen").style.display = "none";
            document.getElementById("quiz-app").style.display = "flex";
            document.getElementById("quiz-container").style.display = "none";
            document.getElementById("action-bar").style.display = "none";
            document.getElementById("loading").style.display = "none";
            document.getElementById("result-screen").style.display = "block";
            
            document.getElementById("city-name").innerText = city.name;
            document.getElementById("city-tags").innerHTML = (city.displayTags || []).map((t) => `<span class="result-tag">${t}</span>`).join("");
            document.getElementById("city-desc").innerText = city.desc;
            
            renderRadar(city, userScores);
        }

        // åœ¨æ§åˆ¶å°æš´éœ²è°ƒè¯•å‡½æ•°
        window.devSkipToResult = devSkipToResult;
    </script>
</body>
</html>